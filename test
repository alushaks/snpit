[?1049h[1;62r(B[m[4l[?7h[?1h=[?1h=[?1h=[39;49m[?25l[39;49m(B[m[H[2J[60;99H(B[0;7m[ Reading File ][3d(B[m[60;98H(B[0;7m[ Read 49 lines[52d(B[m[?12l[?25h[H[39;49m(B[0;7m  GNU nano 2.5.3                                                       File: ./bin/snpit-run.py                                                                                                                     [3;1H(B[0;1m[31m#! /usr/bin/env python[5d#programme to report the lineage/subspecies of a TB sample alligned to NC000962[6d#useage: python SNP-IT.py [guuid] [name of outfile][7d#or for lots of samples: cat [list of samples] | parallel -j[no. of threads] python fasta_typer9.py {} {}.out[8d#Output1: is to file containing absolute and % hits for all subspecies[9d#Output2: only the top call, is to standard out - redirect to file if you want eg 1>calls.log[10d[36mimport[39m(B[m vcf[12d(B[0;1m[36mfrom[39m(B[m snpit (B[0;1m[36mimport[39m(B[m snpit[14d(B[0;1m[36mimport[39m(B[m argparse[16d(B[0;1m[36mif[39m(B[m __name__ == (B[0;1m[32m"__main__"[39m(B[m:[18;5Hparser = argparse.ArgumentParser()[19;5Hparser.add_argument((B[0;1m[32m"--fasta"[39m(B[m,required=False,help=(B[0;1m[32m"the path to the fasta file to read and classify (should be gzipped)"[39m(B[m, dest=(B[0;1m[32m'fasta'[39m(B[m)[20;5Hparser.add_argument((B[0;1m[32m"--vcf"[39m(B[m, required=False, help=(B[0;1m[32m"the path to the vcf file to read and classify (can be zip/gzipped)"[39m(B[m, dest=(B[0;1m[32m'vcf'[39m(B[m)[21;5Hoptions = parser.parse_args()[24;5Hfasta=options.fasta[25;5Hvcf=options.vcf[26d[42m    [27d(B[0;1m[36mif[39m(B[m fasta:[28;9Hinput =fasta[29;5H(B[0;1m[36melse[39m(B[m:[30dinput =vcf[31d[42m    [32d(B[0;1m[31m # now try opening the specified input file[33;5H[36mtry[39m(B[m:[34dTEST = open(input,(B[0;1m[32m'r'[39m(B[m)[35;5H(B[0;1m[36mexcept[39m(B[m IOError:[36;9H(B[0;1m[36mprint[39m(B[m((B[0;1m[32m"input file "[39m(B[m+input+(B[0;1m[32m" does not exist!"[39m(B[m)[38;5Htb_lineage_collection=snpit(threshold=10)[40;5H(B[0;1m[36mif[39m(B[m vcf:[41;9Htb_lineage_collection.load_vcf(input.rstrip())[42;5H(B[0;1m[36melif[39m(B[m fasta:[43;9Htb_lineage_collection.load_fasta(input.rstrip())[44;5H(B[0;1m[36melse[39m(B[m:[45dsys.stdout.write((B[0;1m[32m'Please provide input files'[39m(B[m)[42m [46;5H[49m(B[m(species, lineage, sublineage, percentage)=tb_lineage_collection.determine_lineage()[47d(B[0;1m[31m# print("Most likely lineage is ...")[48;5H[36mif[39m(B[m percentage (B[0;1m[36mis[39m(B[m (B[0;1m[36mnot[39m(B[m None:[49;9H(B[0;1m[36mprint[39m(B[m((B[0;1m[32m"%s\n%20s %16s %16s %.1f %%"[39m(B[m % (input,species,lineage,sublineage,percentage))[50;5H(B[0;1m[36melse[39m(B[m:[51d(B[0;1m[36mprint[39m(B[m((B[0;1m[32m"%s\n%20s %16s %16s %.1f %%"[39m(B[m % (input,(B[0;1m[32m"Unknown"[39m(B[m,(B[0;1m[32m"Unknown"[39m(B[m,None,0))[61d(B[0;7m^G(B[m Get Help[18G(B[0;7m^O(B[m Write Out     (B[0;7m^W(B[m Where Is[52G(B[0;7m^K(B[m Cut Text[69G(B[0;7m^J(B[m Justify[86G(B[0;7m^C(B[m Cur Pos[103G(B[0;7m^Y(B[m Prev Page     (B[0;7mM-\(B[m First Line   (B[0;7mM-W(B[m WhereIs Next (B[0;7m^^(B[m Mark Text     (B[0;7mM-}(B[m Indent Text  (B[0;7mM-U(B[m Undo[62d(B[0;7m^X(B[m Exit[62;18H(B[0;7m^R(B[m Read File     (B[0;7m^\(B[m Replace[52G(B[0;7m^U(B[m Uncut Text    (B[0;7m^T(B[m To Linter     (B[0;7m^_(B[m Go To Line    (B[0;7m^V(B[m Next Page     (B[0;7mM-/(B[m Last Line    (B[0;7mM-](B[m To Bracket   (B[0;7mM-^(B[m Copy Text    (B[0;7mM-{(B[m Unindent Text(B[0;7mM-E(B[m Redo[3d[60d[J[62;212H[62;1H[?1049l[?1l>